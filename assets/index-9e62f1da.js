import{a as o,S as e}from"./sweetalert2.all-b5b6d14e.js";import{createApp as d}from"https://unpkg.com/vue@3/dist/vue.esm-browser.js";const s="https://ec-course-api.hexschool.io/v2",i="michaelhsia",n=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");let a=null,r=null;o.defaults.headers.common.Authorization=n;const u=d({data(){return{products:[],isNew:!1,tempProduct:{imagesUrl:[]}}},methods:{backToLogin(){setTimeout(()=>location.href="login.html",1500)},getProductData(){o.get(`${s}/api/${i}/admin/products/all`).then(t=>{this.products=t.data.products}).catch(t=>alert(`發生錯誤： ${t.response} 請檢查錯誤`))},openModal(t,c){t==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,a.show()):t==="edit"?(this.tempProduct={...c},this.isNew=!1,a.show()):t==="delete"&&(this.tempProduct={...c},r.show())},updateProduct(){this.isNew===!0?o.post(`${s}/api/${i}/admin/product`,{data:this.tempProduct}).then(t=>{e.fire({title:`${t.data.message}`,icon:"success",showConfirmButton:!1,timer:1500}),a.hide(),this.getProductData()}).catch(t=>{e.fire({title:`${t.response.data.message}`,icon:"warning",showConfirmButton:!1,timer:1500})}):this.isNew===!1&&o.put(`${s}/api/${i}/admin/product/${this.tempProduct.id}`,{data:this.tempProduct}).then(t=>{console.log(t.data),e.fire({title:`${t.data.message}`,icon:"success",showConfirmButton:!1,timer:1500}),a.hide(),this.getProductData()}).catch(t=>{e.fire({title:`${t.response.data.message}`,icon:"warning",showConfirmButton:!1,timer:1500})})},delProduct(){o.delete(`${s}/api/${i}/admin/product/${this.tempProduct.id}`).then(t=>{e.fire({title:`${t.data.message}`,icon:"success",showConfirmButton:!1,timer:1500}),r.hide(),this.getProductData(),this.tempProduct={imagesUrl:[]}}).catch(t=>{e.fire({title:`${t.response.data.message}`,icon:"warning",showConfirmButton:!1,timer:1500})})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")}},computed:{total(){return Object.keys(this.products).length}},mounted(){a=new bootstrap.Modal(this.$refs.productModal),r=new bootstrap.Modal(this.$refs.delProductModal),o.post(`${s}/api/user/check`).then(t=>this.getProductData()).catch(t=>{e.fire({title:"你好像還沒登入~",icon:"warning",showConfirmButton:!1,timer:1500}),this.backToLogin()})}});u.mount("#app");
